
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="DarkCloud">
    <title>Scripting with ZeroTier - part 1 - DarkCloud</title>
    <meta name="author" content="Kim Tholstorf">
    
    
        <link rel="icon" href="https://darkcloud.dk/assets/images/avatar_circle.png">
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kim Tholstorf","sameAs":["https://github.com/KimTholstorf","https://twitter.com/KimTholstorf","https://facebook.com/kimtholstorf","https://www.linkedin.com/in/kimtholstorf","mailto:kim@tholstorf.dk"],"image":"avatar_circle.png"},"articleBody":"In a previous post I wrote about using ZeroTier for my homelab and mentioned I ended up writing two scripts:\n\none for joining a network and authorizing the new device\nanother for creating DNS entries in DNSMASQ for DNS lookup\n\nThis first part will focus on how I join my new servers to my ZeroTier labnetwork. For more information about ZeroTier in general go read my other post that go in much more detail about that. Part two about DNS for ZeroTier will soon be available.\nLets get started!\n\n\njoinnetworkThis script will automatically join a new device (node/member) to a ZeroTier network. It can be used standalone or with any provisioning, configuration management, or deployment tools.  The Network ID must be specified to join the network. If an API Token is specified the script will also authorize the member. The script can also autorize an existing member that already have joined but still haven’t been autorized by a network owner/admin.The script depends on curl, jq and zerotier-one to be installed for it to work, though it will check for these to be installed at runtime.\nThe whole idea is to automatically join and authorize a new member to a network so it makes absolute most sense to run it with the --api option. Just running it with --network is the same as just junning zerotier-cli join directly from the shell.\nWhen runnig the script it will right of the bat check if the prequsites a taken care of and preform a simple syntax check for &lt;API-TOKEN&gt; and &lt;NETWORK-ID&gt;. If anything is wrong or missing it will inform you.Next the script will check if the the device (Node ID) is already a member or not. New devices will via zerotier-cli join be joined and if already a member the script will then exit and tell if the member is authorized or not (outputting assigned IP if authorized). If you have specified &lt;API-TOKEN&gt; the script will not just join a member but via curl call the API of the network controller to authorize the member. A existing network member will just be authorized when &lt;API-TOKEN&gt; is specified. Common for both senarios is that the script will exit and output the assigned ZeroTier IP address for the network.NOTE: The script tests via the local zerotier-cli utility when authorization have registered on the client before proceeding. It would be much faster to run these tasks asynchronous, but as I need to use the assigned ZeroTier IP right after the script is done, I wrote it so I could trust the network to be available for the subsequent tasks.\nUsage:To join and authorize a device to a network just run:\n1$ sudo joinnetwork --network=&lt;NETWORK-ID&gt; --api=&lt;API-TOKEN&gt; --member=&lt;NAME-OF-DEVICE&gt;\n\nRuntime options can be set in whatever order you prefer.They can be listed by running joinnetwork --help:\n1234567891011121314151617-a=,  --api=                      Specifies the ZeroTier API Token (account) to authorize the new device member.-u=,  --url=                       URL to a standalone ZeroTier network controller API.Default value is https://my.zerotier.com/api as this is the public network controller hosted by ZeroTier.NOTE: This argument is only for those who run a standalone ZeroTier network controller.    -n=, --network=The ZeroTier network (Network ID) to join.-m=,  --member=                       Set the device member shortname for the member on the ZeroTier network. If not set the unique device Node ID (10-digit alphanumeric) is configured as member shortname.-d=,  --description=                        Set the device member description field for this client.\n\nAlternatively just edit the script variables in the section at line 78 to avoid the need for any runtime parameters.\n\nNETWORK ID is the Network ID you wish to join and must be provided by an admin or existing member. Existing members can see the desired Network ID on the my.zerotier.com Network page or via the zeroctier-cli listnetworks command.\nAPIKEY is your API Access Token from the my.zerotier.com Account page. When specified this token will be used to authorize the new member. \n\nIt’s possible to check if the member is authorized via the API:\n1234# First get your NodeID (some OS require sudo here)$ MYID=$(zerotier-cli info | cut -d \" \" -f 3)#Then call the API$ curl -s -H \"Authorization: Bearer &lt;API-TOKEN&gt;\" https://my.zerotier.com/api /network/&lt;NETWORK-ID&gt;/member/$MYID | jq '.config.authorized'\n\n…or via the webUI:\n\nand last on the local client via zerotier-cli\n1234$ zerotier-cli listnetworks200 listnetworks &lt;nwid&gt; &lt;name&gt; &lt;mac&gt; &lt;status&gt; &lt;type&gt; &lt;dev&gt; &lt;ZT assigned ips&gt;200 listnetworks a09acf02337076f6 already_member f6:6b:c9:a7:ce:aa OK PRIVATE feth4094 172.24.249.40/16200 listnetworks 9bee8941b5a3c534 new_member 36:d8:1a:21:8d:ec OK PRIVATE feth2063 172.25.249.40/16\n\nHammer demotimeIn the demo two things happen: \n\nA new device wil be joinded to a network and given a proper name and description\nA existing member will be Authorized to get proper access and IP assigned. \n\n\n\nCloud-init and the gangI prefer to not overcomplicate tings and for VMs I use cloud-init for initial run conifguration and Ansible for everytning after. As I tend to spin up workloads in diffrent places I very much rely on ZeroTier to even be able to manage or connect these workloads. So it is paramount that the VM is automatically connected to my ZeroTier labnetwork before anything else.I won’t share my entire user-data cloud-config, but here’s a validated example that will install everything needed (zerotier, curl, jq) and then download and execute joinnetwork:\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081#cloud-config#Remember to validate your YAML config via users:  - name: username    sudo: ALL=(ALL) NOPASSWD:ALL    groups: users, admin, sudo    ssh-import-id: gh:UserName    shell: /bin/bashapt:  primary:    - arches: [default]      uri: http://mirrors.dotsrc.org/ubuntu/  sources:    zerotier.list:    # Creates a file in /etc/apt/sources.list.d/ for the sources list entry    source: \"deb http://download.zerotier.com/debian/bionic bionic main\"    key: | # Key from https://github.com/zerotier/ZeroTierOne/blob/master/doc/contact%40zerotier.com.gpg        -----BEGIN PGP PUBLIC KEY BLOCK-----        Comment: GPGTools - https://gpgtools.org        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        =JgAv        -----END PGP PUBLIC KEY BLOCK-----# Install packages on first bootpackages: - curl - jq - zerotier-one# run commands. runcmd only runs during the first bootruncmd: - mkdir -p /run/zerotier - curl -s https://raw.githubusercontent.com/KimTholstorf/zerotier-scripts/master/joinnetwork -o, /run/zerotier/joinnetwork - chmod +x /run/zerotier/joinnetwork - bash /run/zerotier/joinnetwork --api=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX --network=NNNNNNNNNNNNNNNN --member=\"short-name\"final_message: \"The system is ready and prepped (took $UPTIME seconds)\"\n\nNOTE: If you install the cloud-init package on your system you can validate your YAML config via:\n1$ cloud-init devel schema --config-file your-user-data-file.txt\n\nMy scripts for ZeriTier is available on github here.If you find a bug or have a feature request please submit a gitbub issue.\nI think perhaps that is enough for now :) In my next blog article I’ll go through the getnetworkmembers script that pull all networkmembers in a ZeroTier network and create DNS records in DNSMASQ.\n","dateCreated":"2020-02-13T10:48:13+01:00","dateModified":"2020-02-13T14:47:51+01:00","datePublished":"2020-02-13T10:48:13+01:00","description":"In a previous post I wrote about using ZeroTier for my homelab and mentioned I ended up writing two scripts:\n\none for joining a network and authorizing the new device\nanother for creating DNS entries in DNSMASQ for DNS lookup\n\nThis first part will focus on how I join my new servers to my ZeroTier labnetwork. For more information about ZeroTier in general go read my other post that go in much more detail about that. Part two about DNS for ZeroTier will soon be available.\nLets get started!","headline":"Scripting with ZeroTier - part 1","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/"},"publisher":{"@type":"Organization","name":"Kim Tholstorf","sameAs":["https://github.com/KimTholstorf","https://twitter.com/KimTholstorf","https://facebook.com/kimtholstorf","https://www.linkedin.com/in/kimtholstorf","mailto:kim@tholstorf.dk"],"image":"avatar_circle.png","logo":{"@type":"ImageObject","url":"avatar_circle.png"}},"url":"https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/","keywords":"zerotier, bash, json, jq, cloud-init"}</script>
    <meta name="description" content="In a previous post I wrote about using ZeroTier for my homelab and mentioned I ended up writing two scripts:  one for joining a network and authorizing the new device another for creating DNS entries">
<meta name="keywords" content="zerotier,bash,json,jq,cloud-init">
<meta property="og:type" content="blog">
<meta property="og:title" content="Scripting with ZeroTier - part 1">
<meta property="og:url" content="https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/index.html">
<meta property="og:site_name" content="DarkCloud">
<meta property="og:description" content="In a previous post I wrote about using ZeroTier for my homelab and mentioned I ended up writing two scripts:  one for joining a network and authorizing the new device another for creating DNS entries">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/auth.png">
<meta property="og:updated_time" content="2020-02-13T13:47:51.023Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Scripting with ZeroTier - part 1">
<meta name="twitter:description" content="In a previous post I wrote about using ZeroTier for my homelab and mentioned I ended up writing two scripts:  one for joining a network and authorizing the new device another for creating DNS entries">
<meta name="twitter:image" content="https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/auth.png">
<meta name="twitter:creator" content="@KimTholstorf">
    
    
        
    
    
        <meta property="og:image" content="https://darkcloud.dk/assets/images/avatar_circle.png"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-c4ozcsklz4kht2pebhp44xorvyverh23toayhn7i6ubrpyedak24hv1v0hyd.min.css">
    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131086114-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-131086114-1');
    </script>


    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="3">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">DarkCloud</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/avatar_circle.png" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="3">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/avatar_circle.png" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Kim Tholstorf</h4>
                
                    <h5 class="sidebar-profile-bio"><p>passionate about most cloud native technologies, my family, friends and great books</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/KimTholstorf" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://twitter.com/KimTholstorf" target="_blank" rel="noopener" title="Twitter">
                    
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/kimtholstorf" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.linkedin.com/in/kimtholstorf" target="_blank" rel="noopener" title="LinkedIn">
                    
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:kim@tholstorf.dk" target="_blank" rel="noopener" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="3"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Scripting with ZeroTier - part 1
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-02-13T10:48:13+01:00">
	
		    Feb 13, 2020
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>In a <a href="https://darkcloud.dk/2020/02/05/ZeroTier-in-the-homelab/">previous post</a> I wrote about using ZeroTier for my homelab and mentioned I ended up writing two scripts:</p>
<ul>
<li>one for joining a network and authorizing the new device</li>
<li>another for creating DNS entries in <a href="http://www.thekelleys.org.uk/dnsmasq/doc.html" target="_blank" rel="noopener">DNSMASQ</a> for DNS lookup</li>
</ul>
<p>This first part will focus on how I join my new servers to my ZeroTier labnetwork. For more information about ZeroTier in general go read <a href="https://darkcloud.dk/2020/02/05/ZeroTier-in-the-homelab/">my other post</a> that go in much more detail about that. Part two about DNS for ZeroTier will soon be available.</p>
<p>Lets get started!</p>
<a id="more"></a>

<h4 id="joinnetwork"><a href="#joinnetwork" class="headerlink" title="joinnetwork"></a><strong>joinnetwork</strong></h4><p>This script will automatically join a new device (node/member) to a ZeroTier network. It can be used standalone or with any provisioning, configuration management, or deployment tools.  The Network ID must be specified to join the network. If an API Token is specified the script will also authorize the member. The script can also autorize an existing member that already have joined but still haven’t been autorized by a network owner/admin.<br>The script depends on <a href="https://curl.haxx.se/" target="_blank" rel="noopener">curl</a>, <a href="https://stedolan.github.io/jq/" target="_blank" rel="noopener">jq</a> and <a href="https://www.zerotier.com/download/" target="_blank" rel="noopener">zerotier-one</a> to be installed for it to work, though it will check for these to be installed at runtime.</p>
<p>The whole idea is to automatically join <strong>and</strong> authorize a new member to a network so it makes absolute most sense to run it with the <code>--api</code> option. Just running it with <code>--network</code> is the same as just junning <code>zerotier-cli join</code> directly from the shell.</p>
<p>When runnig the script it will right of the bat check if the prequsites a taken care of and preform a simple syntax check for <code>&lt;API-TOKEN&gt;</code> and <code>&lt;NETWORK-ID&gt;</code>. If anything is wrong or missing it will inform you.<br>Next the script will check if the the device (Node ID) is already a member or not. New devices will via <code>zerotier-cli join</code> be joined and if already a member the script will then exit and tell if the member is authorized or not (outputting assigned IP if authorized). If you have specified <code>&lt;API-TOKEN&gt;</code> the script will not just join a member but via <code>curl</code> call the API of the network controller to authorize the member. A existing network member will just be authorized when <code>&lt;API-TOKEN&gt;</code> is specified. Common for both senarios is that the script will exit and output the assigned ZeroTier IP address for the network.<br><strong>NOTE:</strong> The script tests via the local <code>zerotier-cli</code> utility when authorization have registered on the client before proceeding. It would be much faster to run these tasks asynchronous, but as I need to use the assigned ZeroTier IP right after the script is done, I wrote it so I could trust the network to be available for the subsequent tasks.</p>
<p><strong>Usage:</strong><br>To join and authorize a device to a network just run:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo joinnetwork --network=&lt;NETWORK-ID&gt; --api=&lt;API-TOKEN&gt; --member=&lt;NAME-OF-DEVICE&gt;</span><br></pre></td></tr></table></figure>

<p>Runtime options can be set in whatever order you prefer.<br>They can be listed by running <code>joinnetwork --help</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-a=,  --api=                      </span><br><span class="line">Specifies the ZeroTier API Token (account) to authorize the new device member.</span><br><span class="line"></span><br><span class="line">-u=,  --url=                       </span><br><span class="line">URL to a standalone ZeroTier network controller API.</span><br><span class="line">Default value is https://my.zerotier.com/api as this is the public network controller hosted by ZeroTier.</span><br><span class="line">NOTE: This argument is only <span class="keyword">for</span> those who run a standalone ZeroTier network controller.</span><br><span class="line">    </span><br><span class="line">-n=, --network=</span><br><span class="line">The ZeroTier network (Network ID) to join.</span><br><span class="line"></span><br><span class="line">-m=,  --member=                       </span><br><span class="line">Set the device member shortname <span class="keyword">for</span> the member on the ZeroTier network. </span><br><span class="line">If not <span class="built_in">set</span> the unique device Node ID (10-digit alphanumeric) is configured as member shortname.</span><br><span class="line"></span><br><span class="line">-d=,  --description=                        </span><br><span class="line">Set the device member description field <span class="keyword">for</span> this client.</span><br></pre></td></tr></table></figure>

<p>Alternatively just edit the script variables in the section at line 78 to avoid the need for any runtime parameters.</p>
<ul>
<li><code>NETWORK ID</code> is the Network ID you wish to join and must be provided by an admin or existing member. Existing members can see the desired Network ID on the <a href="https://my.zerotier.com/" target="_blank" rel="noopener">my.zerotier.com</a> Network page or via the <code>zeroctier-cli listnetworks</code> command.</li>
<li><code>APIKEY</code> is your API Access Token from the <a href="https://my.zerotier.com/" target="_blank" rel="noopener">my.zerotier.com</a> Account page. When specified this token will be used to authorize the new member. </li>
</ul>
<p>It’s possible to check if the member is authorized via the API:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># First get your NodeID (some OS require sudo here)</span></span><br><span class="line">$ MYID=$(zerotier-cli info | cut -d <span class="string">" "</span> -f 3)</span><br><span class="line"><span class="comment">#Then call the API</span></span><br><span class="line">$ curl -s -H <span class="string">"Authorization: Bearer &lt;API-TOKEN&gt;"</span> https://my.zerotier.com/api /network/&lt;NETWORK-ID&gt;/member/<span class="variable">$MYID</span> | jq <span class="string">'.config.authorized'</span></span><br></pre></td></tr></table></figure>

<p>…or via the webUI:</p>
<div class="figure pic-auth center" style="width:;"><img class="fig-img" src="auth.png" alt></div>
<p>and last on the local client via <code>zerotier-cli</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ zerotier-cli listnetworks</span><br><span class="line">200 listnetworks &lt;nwid&gt; &lt;name&gt; &lt;mac&gt; &lt;status&gt; &lt;<span class="built_in">type</span>&gt; &lt;dev&gt; &lt;ZT assigned ips&gt;</span><br><span class="line">200 listnetworks a09acf02337076f6 already_member f6:6b:c9:a7:ce:aa OK PRIVATE feth4094 172.24.249.40/16</span><br><span class="line">200 listnetworks 9bee8941b5a3c534 new_member 36:d8:1a:21:8d:ec OK PRIVATE feth2063 172.25.249.40/16</span><br></pre></td></tr></table></figure>

<p><del><strong>Hammer</strong></del> <strong>demotime</strong><br>In the demo two things happen: </p>
<ol>
<li>A new device wil be joinded to a network and given a proper name and description</li>
<li>A existing member will be Authorized to get proper access and IP assigned. <script type="text/javascript" src="https://asciinema.org/a/300101.js" id="asciicast-300101" async></script>

</li>
</ol>
<p><strong>Cloud-init and the gang</strong><br>I prefer to not overcomplicate tings and for VMs I use cloud-init for initial run conifguration and <a href="https://www.ansible.com/" target="_blank" rel="noopener">Ansible</a> for everytning after. As I tend to spin up workloads in diffrent places I very much rely on ZeroTier to even be able to manage or connect these workloads. So it is paramount that the VM is automatically connected to my ZeroTier labnetwork before anything else.<br>I won’t share my entire user-data cloud-config, but here’s a validated example that will install everything needed (zerotier, curl, jq) and then download and execute <code>joinnetwork</code>:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#cloud-config</span></span><br><span class="line"><span class="comment">#Remember to validate your YAML config via </span></span><br><span class="line"><span class="attr">users:</span></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">username</span></span><br><span class="line"><span class="attr">    sudo:</span> <span class="string">ALL=(ALL)</span> <span class="attr">NOPASSWD:ALL</span></span><br><span class="line"><span class="attr">    groups:</span> <span class="string">users,</span> <span class="string">admin,</span> <span class="string">sudo</span></span><br><span class="line"><span class="attr">    ssh-import-id:</span> <span class="attr">gh:UserName</span></span><br><span class="line"><span class="attr">    shell:</span> <span class="string">/bin/bash</span></span><br><span class="line"><span class="attr">apt:</span></span><br><span class="line"><span class="attr">  primary:</span></span><br><span class="line"><span class="attr">    - arches:</span> <span class="string">[default]</span></span><br><span class="line"><span class="attr">      uri:</span> <span class="attr">http://mirrors.dotsrc.org/ubuntu/</span></span><br><span class="line"><span class="attr">  sources:</span></span><br><span class="line">    <span class="string">zerotier.list:</span></span><br><span class="line">    <span class="comment"># Creates a file in /etc/apt/sources.list.d/ for the sources list entry</span></span><br><span class="line"><span class="attr">    source:</span> <span class="string">"deb http://download.zerotier.com/debian/bionic bionic main"</span></span><br><span class="line"><span class="attr">    key:</span> <span class="string">| # Key from https://github.com/zerotier/ZeroTierOne/blob/master/doc/contact%40zerotier.com.gpg</span></span><br><span class="line"><span class="string">        -----BEGIN PGP PUBLIC KEY BLOCK-----</span></span><br><span class="line"><span class="string"></span><span class="attr">        Comment:</span> <span class="string">GPGTools</span> <span class="bullet">-</span> <span class="attr">https://gpgtools.org</span></span><br><span class="line"></span><br><span class="line">        <span class="string">mQINBFdQq7oBEADEVhyRiaL8dEjMPlI/idO8tA7adjhfvejxrJ3Axxi9YIuIKhWU</span></span><br><span class="line">        <span class="number">5</span><span class="string">hNjDjZAiV9iSCMfJN3TjC3EDA+7nFyU6nDKeAMkXPbaPk7ti+Tb1nA4TJsBfBlm</span></span><br><span class="line">        <span class="string">CC14aGWLItpp8sI00FUzorxLWRmU4kOkrRUJCq2kAMzbYWmHs0hHkWmvj8gGu6mJ</span></span><br><span class="line">        <span class="string">WU3sDIjvdsm3hlgtqr9grPEnj+gA7xetGs3oIfp6YDKymGAV49HZmVAvSeoqfL1p</span></span><br><span class="line">        <span class="string">pEKlNQ1aO9uNfHLdx6+4pS1miyo7D1s7ru2IcqhTDhg40cHTL/VldC3d8vXRFLIi</span></span><br><span class="line">        <span class="string">Uo2tFZ6J1jyQP5c1K4rTpw3UNVne3ob7uCME+T1+ePeuM5Y/cpcCvAhJhO0rrlr0</span></span><br><span class="line">        <span class="string">dP3lOKrVdZg4qhtFAspC85ivcuxWNWnfTOBrgnvxCA1fmBX+MLNUEDsuu55LBNQT</span></span><br><span class="line">        <span class="number">5</span><span class="string">+WyrSchSlsczq+9EdomILhixUflDCShHs+Efvh7li6Pg56fwjEfj9DJYFhRvEvQ</span></span><br><span class="line">        <span class="number">7</span><span class="string">GZ7xtysFzx4AYD4/g5kCDsMTbc9W4Jv+JrMt3JsXt2zqwI0P4R1cIAu0J6OZ4Xa</span></span><br><span class="line">        <span class="string">dJ7Ci1WisQuJRcCUtBTUxcYAClNGeors5Nhl4zDrNIM7zIJp+GfPYdWKVSuW10mC</span></span><br><span class="line">        <span class="string">r3OS9QctMSeVPX/KE85TexeRtmyd4zUdio49+WKgoBhM8Z9MpTaafn2OPQARAQAB</span></span><br><span class="line">        <span class="string">tFBaZXJvVGllciwgSW5jLiAoWmVyb1RpZXIgU3VwcG9ydCBhbmQgUmVsZWFzZSBT</span></span><br><span class="line">        <span class="string">aWduaW5nIEtleSkgPGNvbnRhY3RAemVyb3RpZXIuY29tPokCNwQTAQoAIQUCV1Cr</span></span><br><span class="line">        <span class="string">ugIbAwULCQgHAwUVCgkICwUWAgMBAAIeAQIXgAAKCRAWVxmII+UqYViGEACnC3+3</span></span><br><span class="line">        <span class="string">lRzfv7f7JLWo23FSHjlF3IiWfYd+47BLDx706SDih1H6Qt8CqRy706bWbtictEJ/</span></span><br><span class="line">        <span class="string">xTaWgTEDzY/lRalYO5NAFTgK9h2zBP1t8zdEA/rmtVPOWOzd6jr0q3l3pKQTeMF0</span></span><br><span class="line">        <span class="number">6</span><span class="string">g+uaMDG1OkBz6MCwdg9counz6oa8OHK76tXNIBEnGOPBW375z1O+ExyddQOHDcS</span></span><br><span class="line">        <span class="string">IIsUlFmtIL1yBa7Q5NSfLofPLfS0/o2FItn0riSaAh866nXHynQemjTrqkUxf5On</span></span><br><span class="line">        <span class="number">65</span><span class="string">RLM+AJQaEkX17vDlsSljHrtYLKrhEueqeq50e89c2Ya4ucmSVeC9lrSqfyvGOO</span></span><br><span class="line">        <span class="string">P3aT/hrmeE9XBf7a9vozq7XhtViEC/ZSd1/z/oeypv4QYenfw8CtXP5bW1mKNK/M</span></span><br><span class="line">        <span class="number">8</span><span class="string">xnrnYwo9BUMclX2ZAvu1rTyiUvGre9fEGfhlS0rjmCgYfMgBZ+R/bFGiNdn6gAd</span></span><br><span class="line">        <span class="string">PSY/8fP8KFZl0xUzh2EnWe/bptoZ67CKkDbVZnfWtuKA0Ui7anitkjZiv+6wanv4</span></span><br><span class="line">        <span class="string">+5A3k/H3D4JofIjRNgx/gdVPhJfWjAoutIgGeIWrkfcAP9EpsR5swyc4KuE6kJ/Y</span></span><br><span class="line">        <span class="string">wXXVDQiju0xE1EdNx/S1UOeq0EHhOFqazuu00ojATekUPWenNjPWIjBYQ0Ag4ycL</span></span><br><span class="line">        <span class="string">KU558PFLzqYaHphdWYgxfGR+XSgzVTN1r7lW87kCDQRXUKu6ARAA2wWOywNMzEiP</span></span><br><span class="line">        <span class="string">ZK6CqLYGZqrpfx+drOxSowwfwjP3odcK8shR/3sxOmYVqZi0XVZtb9aJVz578rNb</span></span><br><span class="line">        <span class="string">e4Vfugql1Yt6w3V84z/mtfj6ZbTOOU5yAGZQixm6fkXAnpG5Eer/C8Aw8dH1EreP</span></span><br><span class="line">        <span class="string">Na1gIVcUzlpg2Ql23qjr5LqvGtUB4BqJSF4X8efNi/y0hj/GaivUMqCF6+Vvh3GG</span></span><br><span class="line">        <span class="string">fhvzhgBPku/5wK2XwBL9BELqaQ/tWOXuztMw0xFH/De75IH3LIvQYCuv1pnM4hJL</span></span><br><span class="line">        <span class="string">XYnpAGAWfmFtmXNnPVon6g542Z6c0G/qi657xA5vr6OSSbazDJXNiHXhgBYEzRrH</span></span><br><span class="line">        <span class="string">napcohTQwFKEA3Q4iftrsTDX/eZVTrO9x6qKxwoBVTGwSE52InWAxkkcnZM6tkfV</span></span><br><span class="line">        <span class="string">n7Ukc0oixZ6E70Svls27zFgaWbUFJQ6JFoC6h+5AYbaga6DwKCYOP3AR+q0ZkcH/</span></span><br><span class="line">        <span class="string">oJIdvKuhF9zDZbQhd76b4gK3YXnMpVsj9sQ9P23gh61RkAQ1HIlGOBrHS/XYcvpk</span></span><br><span class="line">        <span class="string">DcfIlJXKC3V1ggrG+BpKu46kiiYmRR1/yM0EXH2n99XhLNSxxFxxWhjyw8RcR6iG</span></span><br><span class="line">        <span class="string">ovDxWAULW+bJHjaNJdgb8Kab7j2nT2odUjUHMP42uLJgvS5LgRn39IvtzjoScAqg</span></span><br><span class="line">        <span class="number">8</span><span class="string">I817m8yLU/91D2f5qmJIwFI6ELwImkAEQEAAYkCHwQYAQoACQUCV1CrugIbDAAK</span></span><br><span class="line">        <span class="string">CRAWVxmII+UqYWSSEACxaR/hhr8xUIXkIV52BeD+2BOS8FNOi0aM67L4fEVplrsV</span></span><br><span class="line">        <span class="string">Op9fvAnUNmoiQo+RFdUdaD2Rpq+yUjQHHbj92mlk6Cmaon46wU+5bAWGYpV1Uf+o</span></span><br><span class="line">        <span class="string">wbKw1Xv83Uj9uHo7zv9WDtOUXUiTe/S792icTfRYrKbwkfI8iCltgNhTQNX0lFX/</span></span><br><span class="line">        <span class="string">Sr2y1/dGCTCMEuA/ClqGKCm9lIYdu+4z32V9VXTSX85DsUjLOCO/hl9SHaelJgmi</span></span><br><span class="line">        <span class="string">IJzRY1XLbNDK4IH5eWtbaprkTNIGt00QhsnM5w+rn1tO80giSxXFpKBE+/pAx8PQ</span></span><br><span class="line">        <span class="string">RdVFzxHtTUGMCkZcgOJolk8y+DJWtX8fP+3a4Vq11a3qKJ19VXk3qnuC1aeW7OQF</span></span><br><span class="line">        <span class="string">j6ISyHsNNsnBw5BRaS5tdrpLXw6Z7TKr1eq+FylmoOK0pIw5xOdRmSVoFm4lVcI5</span></span><br><span class="line">        <span class="string">e5EwB7IIRF00IFqrXe8dCT0oDT9RXc6CNh6GIs9D9YKwDPRD/NKQlYoegfa13Jz7</span></span><br><span class="line">        <span class="string">S3RIXtOXudT1+A1kaBpGKnpXOYD3w7jW2l0zAd6a53AAGy4SnL1ac4cml76NIWiF</span></span><br><span class="line">        <span class="string">m2KYzvMJZBk5dAtFa0SgLK4fg8X6Ygoo9E0JsXxSrW9I1JVfo6Ia//YOBMtt4XuN</span></span><br><span class="line">        <span class="string">Awqahjkq87yxOYYTnJmr2OZtQuFboymfMhNqj3G2DYmZ/ZIXXPgwHx0fnd3R0Q==</span></span><br><span class="line">        <span class="string">=JgAv</span></span><br><span class="line"><span class="bullet">        -</span><span class="bullet">----END</span> <span class="string">PGP</span> <span class="string">PUBLIC</span> <span class="string">KEY</span> <span class="string">BLOCK-----</span></span><br><span class="line"><span class="comment"># Install packages on first boot</span></span><br><span class="line"><span class="attr">packages:</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">curl</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">jq</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">zerotier-one</span></span><br><span class="line"><span class="comment"># run commands. runcmd only runs during the first boot</span></span><br><span class="line"><span class="attr">runcmd:</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">mkdir</span> <span class="bullet">-p</span> <span class="string">/run/zerotier</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">curl</span> <span class="bullet">-s</span> <span class="attr">https://raw.githubusercontent.com/KimTholstorf/zerotier-scripts/master/joinnetwork</span> <span class="bullet">-o,</span> <span class="string">/run/zerotier/joinnetwork</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">chmod</span> <span class="string">+x</span> <span class="string">/run/zerotier/joinnetwork</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">bash</span> <span class="string">/run/zerotier/joinnetwork</span> <span class="bullet">--api=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span> <span class="bullet">--network=NNNNNNNNNNNNNNNN</span> <span class="bullet">--member="short-name"</span></span><br><span class="line"><span class="attr">final_message:</span> <span class="string">"The system is ready and prepped (took $UPTIME seconds)"</span></span><br></pre></td></tr></table></figure>

<p><strong>NOTE:</strong> If you install the cloud-init package on your system you can validate your YAML config via:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cloud-init devel schema --config-file your-user-data-file.txt</span><br></pre></td></tr></table></figure>

<p>My scripts for ZeriTier is available on github <a href="https://github.com/KimTholstorf/zerotier-scripts" target="_blank" rel="noopener">here</a>.<br>If you find a bug or have a feature request please submit a <a href="https://github.com/KimTholstorf/zerotier-scripts/issues/new" target="_blank" rel="noopener">gitbub issue</a>.</p>
<p>I think perhaps that is enough for now :) In my next blog article I’ll go through the <a href="https://github.com/KimTholstorf/zerotier-scripts#getnetworkmembers" target="_blank" rel="noopener">getnetworkmembers</a> script that pull all networkmembers in a ZeroTier network and create DNS records in DNSMASQ.</p>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/bash/">bash</a> <a class="tag tag--primary tag--small t-link" href="/tags/cloud-init/">cloud-init</a> <a class="tag tag--primary tag--small t-link" href="/tags/jq/">jq</a> <a class="tag tag--primary tag--small t-link" href="/tags/json/">json</a> <a class="tag tag--primary tag--small t-link" href="/tags/zerotier/">zerotier</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2020/02/05/ZeroTier-in-the-homelab/" data-tooltip="ZeroTier in my homelab" aria-label="NEXT: ZeroTier in my homelab">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/" title="Share on Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 Kim Tholstorf. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="3">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2020/02/05/ZeroTier-in-the-homelab/" data-tooltip="ZeroTier in my homelab" aria-label="NEXT: ZeroTier in my homelab">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/" title="Share on Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="3">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/">
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/">
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar_circle.png" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Kim Tholstorf</h4>
        
            <div id="about-card-bio"><p>passionate about most cloud native technologies, my family, friends and great books</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Senior Systems Engineer @ <a href="https://vmware.com">VMware</a></p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Denmark, Copenhagen
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/forestcover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-dbd16rvloemmuxdzniplmnxxvwoz24eya9wol0b7vvmlokgqsjivmb8dnscy.min.js"></script>
<!--SCRIPTS END-->

    
        <script>
             var disqus_config = function () {
                 this.page.url = 'https://darkcloud.dk/2020/02/13/Scripting-with-ZeroTier-part-1/';
                 
                    this.page.identifier = '2020/02/13/Scripting-with-ZeroTier-part-1/';
                 
             };
            (function() {
                var d = document, s = d.createElement('script');
                var disqus_shortname = 'darkcloud';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
    



    </body>
</html>
